<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Tableau de bord</title>
  <script>
    // Configuration d'Outseta
    var o_options = {
      domain: 'votre-sous-domaine.outseta.com', // Remplacez par votre sous-domaine Outseta
      load: 'auth,nocode,profile',
      tokenStorage: 'local', // Permet de maintenir la session utilisateur
      monitorDom: true // Utile si vous utilisez une SPA
    };
  </script>
  <script src="https://cdn.outseta.com/outseta.min.js" data-options="o_options"></script>
</head>
<body>
  <h1>Bienvenue sur votre tableau de bord</h1>
  <p>Crédits disponibles : <strong id="credit-count">Chargement...</strong></p>

  <script>
    // Attendre que le DOM soit prêt
    document.addEventListener('DOMContentLoaded', function () {
      // Vérifier si Outseta est chargé
      if (typeof Outseta === 'undefined') {
        console.error('Outseta n\'est pas défini. Vérifiez que le script est correctement chargé.');
        return;
      }

      // Récupérer les informations de l'utilisateur
      Outseta.getUser().then(function (user) {
        if (user && user.CustomProperties && user.CustomProperties.Credits !== undefined) {
          document.getElementById('credit-count').textContent = user.CustomProperties.Credits;
        } else {
          document.getElementById('credit-count').textContent = 'Non disponible';
          console.warn('Le champ "Credits" n\'est pas défini dans les propriétés personnalisées de l\'utilisateur.');
        }
      }).catch(function (error) {
        console.error('Erreur lors de la récupération des informations utilisateur :', error);
        document.getElementById('credit-count').textContent = 'Erreur';
      });
    });
  </script>
</body>
</html>
